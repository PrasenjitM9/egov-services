{
   "DataConfigs": {
      "serviceName": "rainmaker-pt",
      "version": "1.0.0",
      "mappings": [
         {
            "topic": "pt-pdf-generation",
            "staticConfigPath": "https://raw.githubusercontent.com/egovernments/egov-services/vishal-feature-filestore/core/egov-indexer/src/main/resources/rainmaker-pgr-indexer.yml",
            "mappings": [
               {
                  "direct": [
                     {
                        "variable": "variable1",
                        "value": {
                             "path":"Properties[0].propertyDetails[0].financialYear"                              
                        }
                     },                      
                     {
                        "variable":"variable2",
                        "value":{
                           "path":"Properties[0].oldPropertyId"                            
                        }  
                     },
                     {
                        "variable": "variable3",
                        "value":{
                             "path":"Properties[0].propertyId"                           
                         } 
                     },
                     {
                       "variable": "variable4",
                       "value":{
                            "path":"Properties[0].propertyDetails[0].assessmentNumber"                           
                        } 
                     },
                     {
                       "variable": "variable5",
                       "value":{
                            "path":"Properties[0].address.doorNo"                           
                        } 
                     },
                     {
                       "variable": "variable6",
                       "value":{
                            "path":"Properties[0].address.buildingName"                           
                        } 
                     },
                     {
                       "variable": "variable7",
                       "value":{
                            "path":"Properties[0].address.street"                           
                        } 
                     },
                     {
                       "variable": "variable8",
                       "value":{
                            "path":"Properties[0].address.locality.name"                           
                        } 
                     },
                     {
                       "variable": "variable9",
                       "value":{
                            "path":"Properties[0].propertyDetails[0].landArea"                           
                        } 
                     },
                     {
                       "variable": "variable10",
                       "value":{
                            "path":"Properties[0].propertyDetails[0].propertyType"                           
                        } 
                     },
                     {
                       "variable": "variable11",                        
                       "value":{
                            "path":"Properties[0].propertyDetails[0].owners"                          
                        },
                        "type":"array",
                        "format":{                            
                           "type":"string",
                           "scema":["name","fatherOrHusbandName"]
                       } 
                    },
                    {
                       "variable": "variable12",                        
                       "value":{
                            "path":"Properties[0].propertyDetails[0].units"                          
                        },
                        "type":"array-column",
                        "format":{                            
                           "type":"string",
                           "scema":["floorNo","usageCategoryMajor","usageCategoryDetail","occupancyType","unitArea"]
                       } 
                    } 
                  ]
               },
               {
                  "derived": [
                     {
                        "variable": "$variable",
                        "formula": "$.Data.value + ($.Data.value1 * $.Data.value2) - $.Data.value3"
                     },
                     {
                        "variable": "$variable",
                        "formula": "$.Data.value + ($.Data.value1 * $.Data.value2) - $.Data.value3"
                     }
                  ]
               },
               {
                  "externalAPI": [     
                    {                         
                       "path": "https://egov-micro-dev.egovernments.org/collection-services/receipts/_search",
                       "queryParam": "consumerCode=$.Properties[0].propertyId:$.Properties[0].propertyDetails[0].assessmentNumber",
                       "apiRequest": {
                         "RequestInfo": {
                             "action": "",
                             "apiId": "Rainmaker",
                             "authToken": "b59ec3af-c68f-4445-a2f0-8c2e7c9e5cd5",
                             "did": "1",
                             "key": "",
                             "msgId": "20170310130900|en_IN",
                             "requesterId": "",
                             "ver": ".01"
                         }
                     },
                     
                       "responseMapping":[
                         {             
                            "variable":"variable15",
                            "value":"Receipt[0].receiptNumber"
                         },
                         {
                            "variable":"variable16",
                            "value":"Receipt[0].receiptDate"
                         },
                         {
                            "variable":"variable17",
                            "value":"Receipt[0].Bill[0].billDetails[0].billAccountDetails[7].amount"
                         },
                         {
                            "variable":"variable18",
                            "value":"Receipt[0].Bill[0].billDetails[0].billAccountDetails[3].amount"
                         },
                         {
                            "variable":"variable19",
                            "value":"Receipt[0].Bill[0].billDetails[0].billAccountDetails[2].amount"
                         },
                         {
                            "variable":"variable20",
                            "value":"Receipt[0].Bill[0].billDetails[0].billAccountDetails[8].amount"
                         },
                         {
                            "variable":"variable21",
                            "value":"Receipt[0].Bill[0].billDetails[0].billAccountDetails[4].amount"
                         },
                         {
                            "variable":"variable22",
                            "value":"Receipt[0].Bill[0].billDetails[0].billAccountDetails[6].amount"
                         },
                         {
                            "variable":"variable23",
                            "value":"Receipt[0].Bill[0].billDetails[0].billAccountDetails[0].amount"
                         },
                         {
                            "variable":"variable24",
                            "value":"Receipt[0].Bill[0].billDetails[0].billAccountDetails[1].amount"
                         },
                         {
                            "variable":"variable25",
                            "value":"Receipt[0].Bill[0].billDetails[0].billAccountDetails[5].amount"
                         },
                         {
                            "variable":"variable26",
                            "value":"Receipt[0].Bill[0].billDetails[0].totalAmount"
                         },
                         {
                            "variable":"variable27",
                            "value":"Receipt[0].Bill[0].billDetails[0].amountPaid"
                         },
                         {
                            "variable":"variable28",
                            "value":"Receipt[0].instrument.instrumentType.name"
                         },
                         {
                            "variable":"variable29",
                            "value":"Receipt[0].instrument.bank.name"
                         },
                         {
                            "variable":"variable30",
                            "value":"Receipt[0].transactionId"
                         },
                         {
                            "variable":"variable31",
                            "value":"Receipt[0].instrument.transactionDateInput"
                         }
                     
                      ]  
                     }
                  ]
               },
               {
                  "mdmsDenormalization": [
                     {
                        "variable": "$variable",
                        "moduleName": "common-masters",
                        "masterName": "Department",
                        "tenantId": "pb",
                        "filter": "[?(@.code == $department)]",
                        "filterMapping": [
                           {
                              "variable": "$department",
                              "valueJsonpath": "$.department"
                           }
                        ],
                        "valueJsonPath": "$.TenantBoundary[0].boundary[0].name"
                     },
                     {
                        "variable": "$variable",
                        "moduleName": "common-masters",
                        "masterName": "Department",
                        "tenantId": "pb",
                        "filter": "[?(@.code == $department)]",
                        "filterMapping": [
                           {
                              "variable": "$department",
                              "valueJsonpath": "$.department"
                           }
                        ],
                        "valueJsonPath": "$.TenantBoundary[0].boundary[0].name"
                     }
                  ]
               }
            ]
         }
      ]
   }
}
