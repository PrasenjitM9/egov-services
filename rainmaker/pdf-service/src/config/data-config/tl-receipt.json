{
    "DataConfigs": {
       "serviceName": "rainmaker-tl",
       "version": "1.0.0",
       "baseKeyPath": "$.Licenses.*",
       "mappings": [
          {
             "topic": "tl-pdf-generation",
             "staticConfigPath": "https://raw.githubusercontent.com/egovernments/egov-services/vishal-feature-filestore/core/egov-indexer/src/main/resources/rainmaker-pgr-indexer.yml",
             "mappings": [
                {
                   "direct": [
                                            
                      {
                        "variable": "variable1",
                        "value": {
                             "path":"$.tradeLicenseDetail.additionalDetail.applicationType"                              
                        },
                        "localisation":{
                           "required":true,
                           "prefix":"TRADELICENSE_APPLICATIONTYPE",   
                           "module":"rainmaker-tl"
                        }
                     },
                     {
                        "variable": "variable2",
                        "value": {
                             "path":"$.oldLicenseNumber"                              
                        }
                     },
                      {
                         "variable": "variable3",
                         "value":{
                              "path":"$.applicationNumber"                           
                          } 
                      },
                      {
                        "variable": "variable4",
                        "value": {
                             "path":"$.financialYear"                              
                        }
                     },
                     {
                        "variable": "variable5",
                        "value": {
                             "path":"$.tradeName"                              
                        }
                     },
                     {
                        "variable": "variable6",
                        "value": {
                             "path":"$.tradeLicenseDetail.tradeUnits[0].tradeType"                              
                        },
                        "localisation":{
                           "required":true,
                           "prefix":"TL",   
                           "module":"rainmaker-tl"
                        }
                     },
                     {
                        "variable": "variable7",
                        "value": {
                             "path":"$.tradeLicenseDetail.tradeUnits[0].tradeType"                              
                        },
                        "localisation":{
                           "required":true,
                           "prefix":"TL",   
                           "module":"rainmaker-tl"
                        }
                     },
                     {
                        "variable": "variable8",
                        "value": {
                             "path":"$.tradeLicenseDetail.accessories[0].accessoryCategory"                              
                        }
                     },
                     {
                        "variable": "variable9",
                        "value": {
                             "path":"$.tradeLicenseDetail.address.doorNo"                              
                        }
                     },
                     {
                        "variable": "variable10",
                        "value": {
                             "path":"$.tradeLicenseDetail.address.buildingName"                              
                        }
                     },
                     {
                        "variable": "variable11",
                        "value": {
                             "path":"$.tradeLicenseDetail.address.street"                              
                        }
                     },
                     {
                        "variable": "variable12",
                        "value": {
                             "path":"$.tradeLicenseDetail.address.locality.name"                              
                        }
                     },
                      {
                        "variable": "variable13",                        
                        "value":{
                             "path":"$.tradeLicenseDetail.owners.*"                          
                         },
                         "type":"array",
                         "format":{                            
                            "type":"string",
                            "scema":["name","mobileNumber"]
                        } 
                     } 
                   ]
                },
                {
                   "derived": [
                      {
                         "variable": "$variable",
                         "formula": "$.Data.value + ($.Data.value1 * $.Data.value2) - $.Data.value3"
                      },
                      {
                         "variable": "$variable",
                         "formula": "$.Data.value + ($.Data.value1 * $.Data.value2) - $.Data.value3"
                      } 
                   ]
                },
                {
                   "externalAPI": [
                     
                      {
                         
                         "path": "https://egov-micro-dev.egovernments.org/collection-services/receipts/_search",
                         "queryParam": "consumerCode=$.applicationNumber",
                         
                         
                         "apiRequest": {
                           "RequestInfo": {
                               "action": "",
                               "apiId": "Rainmaker",
                               "authToken": "1e37ea94-13cd-4e58-9dde-6c133a0a6902",
                               "did": "1",
                               "key": "",
                               "msgId": "20170310130900|en_IN",
                               "requesterId": "",
                               "ver": ".01"
                              }
                           },

                         "responseMapping":[
                           {
                              "variable":"variable16",
                              "value":"$.Receipt[0].receiptNumber"
                           },
                           {
                              "variable":"variable17",
                              "value":"$.Receipt[0].instrument.transactionDateInput"
                           },                           
                           {
                              "variable":"variable18",
                              "value":"$.Receipt[0].Bill[0].billDetails[0].totalAmount"
                           },
                           {
                              "variable":"variable19",
                              "value":"$.Receipt[0].Bill[0].billDetails[0].totalAmount"
                           },
                           {
                              "variable":"variable20",
                              "value":"$.Receipt[0].Bill[0].billDetails[0].amountPaid"
                           },
                           {
                              "variable":"variable21",
                              "value":"$.Receipt[0].instrument.transactionType"
                           },
                           {
                              "variable":"variable22",
                              "value":"$.Receipt[0].transactionId"
                           },
                           {
                              "variable":"variable23",
                              "value":"$.Receipt[0].instrument.bank.name"
                           },
                           {
                              "variable":"variable24",
                              "value":"$.Receipt[0].Bill[0].billDetails[0].manualReceiptNumber"
                           },
                           {
                              "variable":"variable25",
                              "value":"$.Receipt[0].Bill[0].billDetails[0].manualReceiptDate"
                           },
                           {
                              "variable":"variable26",
                              "value":"$.Receipt[0].Bill[0].billDetails[0].billAccountDetails[?(@.taxHeadCode=='PT_TIME_PENALTY')].amount"
                           },
                           {
                              "variable":"variable27",
                              "value":"$.Receipt[0].Bill[0].billDetails[0].billAccountDetails[?(@.taxHeadCode=='PT_TIME_REBATE')].amount"
                           }
                        ]  
                      }
                   ]
                },
                {
                   "mdmsDenormalization": [
                      {
                         "variable": "$variable",
                         "moduleName": "common-masters",
                         "masterName": "Department",
                         "tenantId": "pb",
                         "filter": "[?(@.code == $department)]",
                         "filterMapping": [
                            {
                               "variable": "$department",
                               "valueJsonpath": "$.department"
                            }
                         ],
                         "valueJsonPath": "$.TenantBoundary[0].boundary[0].name"
                      },
                      {
                         "variable": "$variable",
                         "moduleName": "common-masters",
                         "masterName": "Department",
                         "tenantId": "pb",
                         "filter": "[?(@.code == $department)]",
                         "filterMapping": [
                            {
                               "variable": "$department",
                               "valueJsonpath": "$.department"
                            }
                         ],
                         "valueJsonPath": "$.TenantBoundary[0].boundary[0].name"
                      }
                   ]
                }
             ]
          }
       ]
    }
 }
